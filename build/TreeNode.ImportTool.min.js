/*! TreeNode 2013-11-29 */
!function(a){"use strict";function b(a,c){var d="\n(",e=")";a.rows.push(d+["'"+c.data.text+"'",c.Lft,c.Rgt,c.data.page_id||"NULL",c.data.url||"NULL"].join(",")+e);for(var f=0,g=c.children.length;g>f;f++)b(a,c.children[f])}a.prototype.ExportInserts=function(b){return b=b||{},b.context=this,new a.InsertWriter(b)},a.InsertWriter=function(c){if(!(this instanceof a.InsertWriter))return new a.InsertWriter(c);var d,e=c.context,f="INSERT INTO `nav` (`name`, `lft`, `rgt`, `page_id`, `url`)\nVALUES",g=";";return this.Statement=function(){return d},this.Context=function(){return e},void 0===e.Lft&&e.Decorate("LftRgt"),this.rows=[],b(this,this.Context()),d=f+this.rows.join(",")+g,this}}(this.TreeNode),function(a){"use strict";function b(a,c,d){var e,f=a.data,g="",h=c.indexOf(a);d&&d.indexOf(a)>=0||(e=parseInt(f.lft,10)!==a.Lft||parseInt(f.rgt,10)!==a.Rgt,(e||c&&h>=0)&&(g+="UPDATE `nav`\nSET\n",g+="`lft` = "+a.Lft,g+=",\n`rgt` = "+a.Rgt,c&&h>=0&&(g+=",\n`name` = '"+f.text+"',\n",g+="'"+f.url+"'",g+=",\n`page_id` = "+(f.page_id||"NULL"),c.splice(h,1)),g+="\nWHERE id = "+f.id+";\n"));for(var i=0,j=a.children.length;j>i;i++)g+=b(a.children[i],c,d);return g}function c(a){var b="";if(a&&a.length){b="INSERT INTO `nav` (`name`, `lft`, `rgt`, `page_id`, `url`)\nVALUES";for(var c=0,d=a.length;d>c;c++)b+=c?",":"",b+="\n("+["'"+a[c].Payload().text+"'",a[c].Lft,a[c].Rgt,a[c].data.page_id||"NULL",a[c].data.url?"'"+a[c].data.url+"'":"NULL"].join(",")+")";b+=";"}return b}function d(a){var b="";if(a&&a.length)for(var c=0,d=a.length;d>c;c++)b+="DELETE FROM `nav`\n",b+="WHERE `id` = "+a[c].data.id+";\n";return b}a.prototype.ExportUpdates=function(b){return b=b||{},b.context=this,new a.UpdateWriter(b)},a.UpdateWriter=function(e){if(!(this instanceof a.UpdateWriter))return new a.UpdateWriter(e);var f,g,h,i,j=e.context,k=e.updates,l=e.inserts,m=e.deletes;this.Statement=function(){return i},this.Context=function(){return j},void 0===j.Lft&&j.Decorate("LftRgt"),f=b(j,k,l),g=c(l),h=d(m),i=f,i+=i&&g?"\n\n"+g:g,i+=i&&h?"\n\n"+h:h}}(this.TreeNode),function(a){"use strict";a.ImportFromJSON=function(b){if(b){var c,d,e=new a,f=b.data,g=b.childKey||"children",h=b.textKey||"text",i=b.urlKey||"url";e.data=e.data||{};for(var j in f)if(f.hasOwnProperty(j))switch(j){case g:for(c=0,d=f[j].length;d>c;c++)e.add(a.ImportFromJSON({data:f[j][c],childKey:g,textKey:h,urlKey:i}));break;case h:e.data.text=f[j];break;case i:e.data.url=f[j];break;default:e.data[j]=f[j]}return e}}}(window.TreeNode),function(a){"use strict";a.ImportFromLftRgt=function(b){var c,d,e,f;if(b){b=b.split("\n");for(var g=0,h=b.length;h>g;g++)if(e=b[g].split("	"),f={id:e[0],text:e[1],lft:e[2],rgt:e[3],url:"NULL"===e[5]?null:e[5],page_id:"NULL"===e[4]?null:e[4]},c){for(;e[2]>parseInt(c.data.rgt,10);)c=c.parent;c=c.add(new a(f))}else c=new a(f),d=c}return d}}(this.TreeNode),function(a){"use strict";function b(b,c){c[b[1]]=c[b[0]].add(new a({parent:b[0],id:b[1],text:b[2],page_id:b[3]?b[1]:null}))}a.ImportFromSelfRef=function(c){var d,e,f,g=[],h={};if(c){c=c.split("\n"),e=c[0].split("	"),d=new a({parent:e[0],id:e[1],text:e[2],page_id:e[3]?e[1]:null}),h[e[1]]=d;for(var i=1,j=c.length;j>i;i++)f=c[i].split("	"),f[0]&&(h[f[0]]?(b(f,h),g.length&&h[g[0][0]]&&b(g.shift(),h)):g.push(f));return d}}}(this.TreeNode),TreeNode.StatementWriter=function(){};